---
title: "Bullying Network"
author: "Aurora Maria Tumminello, Lucia Hrovatin"
output: 
  html_notebook: 
    toc: yes
    highlight: monochrome
    theme: journal
---

# Importing data

## Data Structure

The original dataset `bullying_network.xlsx` is an Excel file that contains two sheets about bullying within a group of 25 students in an Italian school class: the first one contains three attributes per student; the second one represents the adjacency matrix of a directed network depicting who bullies whom among the students. 

The first sheet, the attributes one, contains:

- **gender**, mapped in females (0) and males (1);
- **grade**, which goes from 0 to 10;
- **ethnicity**, divided into three categories: first-generation immigrants (born abroad with foreign parents), second-generation immigrants (born in Italy with foreign parents) and Italians (born in Italy with at least one Italian parent).

## Data pre-processing

As forehead described, the original excel file contains two sheets. The first approach consisted in using the `read_excel(path, sheet)` function, by saving the first and the second sheet separately in different variables.  Since this attempt implied a network misreading of 0s and 1s as characters instead of double and creating an undirected network, we opted for a more correct importing action: the original excel file has been manually split into two separate csv files:

- `bullying_attributes.csv`: containing the attributes of students inside the network;
- `bullying_network.csv`: containing the actual adjacency matrix (i.e. the network).

## Libraries

```{r}
library(tidyverse)
library(sna)
library(itsadug) # For gradient legend
library(knitr)
library(formattable)

customGreen0 = "#DeF7E9"
customGreen = "#71CA97"
customRed = "#ff7f7f"
```

## Data import

### Import network data

With the following code, the network is imported, converted into matrix and then into directed network.

```{r}
# Importing data
net = as.matrix(read.csv("bullying_network.csv",
                         stringsAsFactors=FALSE, row.names=1))
# Converting the adjacency matrix to a network
net = as.network(net, directed=T)
# Inspect the network
summary(net, print.adj = FALSE)
```

By inspecting the obtained network through `summary(net)`, we may notice:

- the number of vertices (i.e. nodes), which are 25 students;
- that the network is directed;
- that no hyperedges, loops or multiple edges are allowed;
- that there are 76 edges;
- that the density is 0.1266667, which will be our focus in the centralisation section;
- that nodes have names, which correspond to studentsâ€™ first names.

### Import attributes

Students attributes are saved in an additional file and therefore imported separately. 

```{r}
# Reading the csv file with node attributes
attr = read.csv("bullying_attributes.csv")
```


# Drawing a network

## Basic Draw

<aside>
ðŸ’¡ *Draw the network using the Fruchterman-Reingold layout with names (but without attributes).*
</aside>

```{r}
par(mar=c(0,0,0,0)) # Margin deletion
gplot(net,
      gmode="digraph",    # directed network
			mode="fruchtermanreingold", # set mode as Fruchterman-Reingold
      jitter=F,           # do not allow nodes to be "jittered"
      edge.col="grey70",  # set color of ties
      vertex.col="cornflowerblue",   # set color of nodes
			vertex.sides = 100,
      displaylabels=T,    # indicate that labels should be included
      label.pos=1,        # indicate that labels should be given below points
      label.cex=.7,       # indicate the size of the labels (1 is default)
			arrowhead.cex = 0.4,
			object.scale = 0.01)
```

The *Fruchterman-Reingold* layout is the default mode of the `gplot()` function and therefore it is not necessary to include it. Overall there are 25 labelled nodes connected through directed links which represent who bullies whom. In particular, there is a student, Roberto, that does not present incoming or outgoing edges and, following the definition of Wasserman & Faust (1994), it is defined as an isolate [Wasserman, S., & Faust, K. (1994). Social network analysis: Methods and applications]. Therefore, Roberto is the only student in this specific school class that is not bullied and does not bully either.  


## Attribute-based network

<aside>
ðŸ’¡ *Next, draw the network again using the Fruchterman-Reingold layout without names, but now with all 3 attributes (gender, grade and ethnicity) included using in some way a combination of colour, shape and size of nodes.*

</aside>

<aside>
ðŸ’¡ *Create a legend for the attributes (this does not have to be with R, but needs to clarify how the different attributes were represented in the network).*

</aside>

Once again, letâ€™s consider the three attributes and their respective values:

- **Gender**: binomial variable 0/1;
- **Ethnicity**: categorical variable assuming three different values (1,2 or 3);
- **Grade**: categorical variable assuming 11 different values (from 0 to 10).

These attributes could be mapped in many different ways considering the shape, the colour and the size of nodes. 

### First version

A first version considers:

- size: grade;
- shape: gender;
- colour: ethnicity.

```{r}
# SIZE: Grade
# SHAPE: Gender
# COLOR: Ethnicity

colours_1 = c("#2a9d8f", "#e9c46a", "#e76f51")
sizes = seq(0.1, 4, length.out=11)

par(mar=c(0,0,0,0))
gplot(net,
      gmode="digraph",    # directed network
      jitter=T,
      edge.col="grey70",  # set color of ties
      vertex.col=colours_1[attr$Ethnicity], # set color of nodes depending on ethnicity
      vertex.cex = sizes[attr$Grade], # set size of nodes depending on grade
      vertex.sides= (attr$Gender-1)*47+4, # set shape of nodes depending on gender
			vertex.rot = 45, # Nodes rotation
      arrowhead.cex = 0.5) # Size of the arrows head
```
In this representation, both gender and ethnicity are evident, while the grade is not accurately represented by the size. In this last case, the logarithm has been applied to the grade attribute in order to represent nodes properly and scale them, but still without being able to distinguish the difference in terms of grades.

In the following chunk, a legend is added to guide the user in the reading of the network:

- ethnicity, through colours, represents 1st and2nd generation of immigrants, plus the Italians;
- shapes map the gender of students: circles for males and squares for females;
- grades vary in terms of size, whose proportion is depicted in the legend, despite is not exactly the same represented in the network.

```{r}
sizes = seq(0.2, 3, length.out=11)

par(mar=c(0,0,0,0)) # Margin deletion
gplot(net,
      gmode="digraph",    # directed network
      jitter=T,           
      edge.col="grey70",  # set color of ties
      vertex.col=colours_1[attr$Ethnicity],   # set color of nodes depending on ethnicity 
      vertex.cex = sizes[attr$Grade], # set size of nodes depending on grade
      vertex.sides= sides[attr$Gender+1], # set shape of nodes depending on gender  
      vertex.rot = 45,
      arrowhead.cex = 0.5,
      displaylabels=T,    # indicate that labels should be included
      label.pos=1,        # indicate that labels should be given below points
      label.cex=.7)       # indicate the size of the labels (1 is default)
legend("topleft",
       legend = c("Ethnicity"," 1st gen immigrants", " 2st gen immigrants", " Italian",
                  " ", "Gender", " Male", " Female",
                  " ", "Grade", 0:10),
       col = c("white",colours_1[1],colours_1[2],colours_1[3],
               "white","white","black","black",
               "white", "white", rep("black",11)), 
       bty = "n", 
       pch =c(15,15,15,15,
              15,15,19,15,
              15,15,rep(19,11)),
       pt.cex = c(0,2.1,2.1, 2.1,
                  0,0,2.1,2.1,
                  0, 0, (0:10)/5), 
       cex = 1, 
       text.col = "grey10", 
       horiz = F , 
       inset = c(0.01))
```

### Second version

A second approach is to represent attributes as such:

- shape: ethnicity (i.e. first-generation as triangles, second-generation as squares and Italians as circles);
- hue: gender (i.e. females as red, males as green);
- colour lightness: grade (the darker the higher, the lighter the lower).

```{r}
# SIZE: Grade
# SHAPE: Gender
# COLOR: Ethnicity

colours_2 = c('#fff0f3', '#ffccd5', '#ffb3c1', '#ff8fa3', '#ff758f', 
           '#ff4d6d', '#c9184a', '#a4133c', '#800f2f', '#590d22',
           "#d8f3dc","#b7e4c7","#95d5b2","#74c69d","#52b788",
           "#40916c", "#2d6a4f","#245741","#1b4332","#081c15"
)

shapes = c(3,4,50)

par(mar=c(0,0,0,0)) # Margin deletion
gplot(net,
      gmode="digraph",    # directed network
      jitter=F,           # do not allow nodes to be "jittered"
      edge.col="grey70",  # set color of ties
      vertex.col=colors[attr$Gender*10+attr$Grade+1],   # set color of nodes
      vertex.cex = 1.3,
      vertex.rot = 45,
      vertex.sides= shapes[attr$Ethnicity],
      arrowhead.cex = 0.5)
```
Despite ethnicity is not so evident as before, in this case, gender is discernible through the hue of nodes and grade through the use of lightness in the choice of colours. In fact, darker colours indicate higher grades and the difference is perceptible with respect to the previous case where size was used. 

Notice that the application of size variation with respect to gender or ethnicity may unconsciously suggest a social superiority of one of the categories, which does not exist. Moreover, colours and shapes are sufficient to represent categorical variables with less than 3 values.

In this case, the legend shows:

- ethnicity as one of the shapes;
- gender as one of the two colours;
- grade as a gradient, varying between males and females, whose lightness relies on the studentsâ€™ grade.

This solution may help to understand the grade distribution among students, but still, the exact grade is difficult to get.

```{r}
par(mar=c(0,0,0,0)) # Margin deletion
gplot(net,
      gmode="digraph",    # directed network
      jitter=T,           # do not allow nodes to be "jittered"
      edge.col="grey70",  # set color of ties
      vertex.col=colors[attr$Gender*10+attr$Grade+1],   # set color of nodes
      vertex.cex = 1,
      vertex.rot = 45,
      vertex.sides= shapes[attr$Ethnicity],
      displaylabels=T,    # indicate that labels should be included
      arrowhead.cex = 0.5,
      label.pos=1,        # indicate that labels should be given below points
      label.cex=.7)       # indicate the size of the labels (1 is default))

# Legend for gender and ethnicity
legend("topleft",
       legend = c("Ethnicity"," 1st gen immigrants", " 2st gen immigrants", " Italian",
                  " ", "Gender", " Male", " Female",
                  " ", "Grade"),
       col = c("white","black","black", "black",
               "white","white","#52b788","#ff4d6d",
               "white", "white"), 
       bty = "n", 
       pch =c(15,17,15,19,
              15,15,15,15,
              15, 15),
       pt.cex = c(0,2.1,2.1, 2.2,
                  0,0,2.1,2.1,
                  0,0), 
       cex = 1, 
       text.col = "grey10", 
       horiz = F , 
       inset = c(0.01))

# Gradient legend
pal = colorRampPalette(colors[1:10])
gradientLegend(valRange=c(0,10), 
               color = pal(10),
               pos=c(0.05,0.1,.08,0.5), 
               side=4, 
               n.seg=1,
               border.col = "grey10",
               inside = T)

pal = colorRampPalette(colors[11:20])
gradientLegend(valRange=c(0,10), 
               color = pal(10),
               pos=c(0.12,0.1,.15,0.5), side=4,
               n.seg=1,
               border.col = "grey10",
               inside = T)
```



# Centrality

<aside>
ðŸ’¡ *Calculate in and out-degree centrality for each node and interpret the results.*

</aside>


**Degree centrality** is defined as the number of links incident upon a node. Having a directed network implies splitting the degree into in degree and out degree. The former counts the number of incoming edges to a node, while the latter refers to the number of edges a node directs to others [Freeman, L. C. (1978), Centrality in social networks conceptual clarification. Social networks, 1(3), 215-239.]. 

When edges express positive aspects (e.g., friendship, collaboration), in degree can be interpreted as a form of popularity and out degree as gregariousness. However, a reversed scenario is presented here due to the edges' negative connotation, i.e. bullying.

## In-degree

<aside>
ðŸ’¡ *Who is the most central when it comes to indegree?*

</aside>

<aside>
ðŸ’¡ *Provide details of the meaning of the value (taking into account that the network is "who do you bully?").*

</aside>

<aside>
ðŸ’¡ *Make sure to discuss the reference points for the in-degree measure. How does it compare to the theoretical minimum and maximum value?*

</aside>

Letâ€™s first consider the in-degree centrality of nodes with the function `degree(network, gmode, cmode="indegree")`, which will return the in-degree for each student. The same function can be used to compute the out-degree, setting `cmode="outdegree"`.

```{r}
# How many people are you bullied from?
indegree = sna::degree(net, gmode="digraph", cmode = "indegree")

# How many people do you bully? 
outdegree = sna::degree(net, gmode="digraph", cmode = "outdegree")

# Overall Degree
degree = sna::degree(net, gmode="digraph")
```

In order to properly present the degrees, a dataframe has been created, with names, in-degree, out-degree and total degree (i.e. sum of both in and out-degree). 

```{r}
# Create dataframe with names, in and out-degree
names = get.vertex.attribute(net, "vertex.names")
people = data.frame(Name = names)
people$indegree = indegree
people$outdegree = outdegree
people$degree = degree

# Normalized indegree
nodes = length(net$val) - 1
people$norm_indegree = round(people$indegree / nodes,2)

people %>%
  arrange(desc(indegree)) %>%
  formattable(align = c("l",rep("c",4)),
              'Name' = formatter("span", style = ~ style(color = "grey",font.weight = "bold")),
              'indegree' = color_tile(customGreen, customGreen0),
              'outdegree' = color_tile(customGreen, customGreen0),
              'degree' = color_tile(customGreen, customGreen0),
              'norm_degree' = color_tile(customGreen, customGreen0))
```

The average is strongly impacted by the unbalanced situation within the network, meaning a group of six highly bullied victims against the remaining nodes assessing low in-degree values. The extreme cases ($indegree = 0$) are further analysed in the following sections and might reflect either isolate (i.e., Roberto) or bully figures. 

```{r}
avg_indegree = mean(people$indegree)
message("Average in degree: ", avg_indegree)
median_indegree = median(sort(people$indegree))
message("Median in degree: ", median_indegree)


results = data.frame(Measures = c("Most central node", 
                                  "Max in degree",
                                  "(Theoretical) max in degree", 
                                  "Min in degree", 
                                  "(Theoretical) min in degree",
                                  "Average in degree", 
                                  "Median in degree"))
results$Value = c(people[which.max(people$indegree),]$names,
                  max(people$indegree),
                  nodes,
                  min(people$indegree),
                  0, 
                  avg_indegree, 
                  median_indegree)

formattable(results,
            'Measure' = formatter("span", style = ~ style(color = "grey",font.weight = "bold")))
```

```{r}
# In-degree distribution among nodes
ggplot(people)+
  geom_histogram(aes(x=indegree), stat="count", fill="cornflowerblue")+
  labs(title = "Distribution of in degree")+
  xlab("In degree centrality")+ylab("Number of students")


person = people[order(people$indegree), ]$names

barplot(sort(people$indegree),
     main="Histogram for Indegree Values",
     names.arg = person,
     ylab="Indegree",
     border="#a8dadc",
     col="#a8dadc",
     las = 2)
abline(a=avg_indegree, b= 0, col = "red")
text(1,4, "avg indegree = 3.04", col = 2, adj = c(0, -.1))
```

By taking into consideration the in-degree centrality, Sara can be defined as the most central node, followed by Gianna and Marco. As stated above, whereas in several cases having many incoming edges represents an advantageous condition for the individual, this specific network emphasizes an unfavourable status. Thus, in degree measure refers to the number of bullies a node must face. Consequently, Sara results the chosen victim and gets bullied by nine people, which corresponds to the $0.375\%$ of the other nodes (normalization obtained by $\frac{indegree}{n-1} = \frac{9}{24} = 0.375$, with $n$ number of nodes). 

In the worst case scenario, Sara would be bullied by 24 students and she would be the only victim. However, despite her seeming far from the depicted scenario, her in-degree looks extremely high considering the average and the median in the degree of the entire network. The same happens for students like Gianna, Marco, Andrea, Mario and Valentina. 

It is also worth noticing that Sara's condition seems not to be determined by her ethnicity but by her grade. While at least one member per ethnicity has been bullied, the reason for Sara's centrality might be the achievement of the highest mark: $10$.


### Outdegree
-   Who is the most central when it comes to outdegree?

-   Provide details of the meaning of the value (taking into account that the network is "who do you bully?").

-   Make sure to discuss the reference points for the outdegree measure. How does it compare to the theoretical minimum and maximum value?

```{r}
# How many people do you bully? 
outdegree = sna::degree(net, gmode="digraph", cmode = "outdegree")
people$outdegree = outdegree
max_od = max(outdegree)

# Normalized outdegree
people$norm_outdegree = people$outdegree / nodes 
people$norm_outdegree

people %>%
  arrange(desc(outdegree))
```

There is no unique central node in the case of the out degree measure. Thus, Angela, Aurora, and Francesco can be detected as the three most central nodes (as shown in the network below). It is also worth noticing that their degree measure is assessed at $9$ and, therefore, they are not the extreme cases hypothesised above (i.e., $indegree=0$). As already performed in the indegree case, some reference points are computed and reported below.


```{r}
par(mar=c(0,0,0,0)) # Margin deletion
gplot(net,
      gmode="digraph",    # directed network
      jitter=F,
      edge.col="grey70",  # set color of ties
      vertex.col= ifelse(outdegree == max_od , "salmon", "lightblue"),
      vertex.cex = sizes[outdegree]+1,
      displaylabels=T,    # indicate that labels should be included
      label.pos=1,        # indicate that labels should be given below points
      label.cex=.7)       # indicate the size of the labels (1 is default)
```

 

```{r}

avg_outdegree = mean(people$outdegree)
median_outdegree = median(sort(people$outdegree))

headers = c("Most central", "Max outdegree", "Min outdegree", "Avg outdegree", "Median outdegree")
outdegree_measure = c(tail(sort(people$outdegree), n=1), nodes, 0, avg_outdegree , median_outdegree )
tab = rbind(headers, outdegree_measure, deparse.level = 0 )                   
knitr::kable(tab, caption = "Summary table of the outdegree reference points")

```

Each of the three central out degree nodes bullies almost one-third of the overall network: 
\[ \frac{outdegree}{n-1} = \frac{7}{24} = 0.291 \approx 0.29 \approx 1/3\]
These values are high above the average of `r avg_outdegree` $\pm$ `r round(sd(people$outdegree),2)` but do reach extreme cases, such as a centralized network (i.e., maximum outdegree). Therefore, a visual interpretation of the outdegree distribution in a bar plot graph may help understand the underlying reasons for low reference points.    

```{r}
person = people[order(people$outdegree), ]$names 

barplot(sort(people$outdegree), 
     main="Histogram for Outdegree Values",
     names.arg = person,
     ylab="Outdegree",
     border="#81b29a", 
     col="#81b29a", 
     las = 2)
abline(a=avg_outdegree, b= 0, col = "red")
text(1,4, "avg indegree = 3.04", col = 2, adj = c(0, -.1)) 
```

Once again, the outdegree measure shows an imbalanced situation assessing a significant gap between the lowest extreme cases, such as 0, and the highest ones.  The imbalance is determined by the three central nodes that become the primary senders of bullying acts. 

------------------------------------------------------------------------

*Let's assume we hypothesize that the grade of students might be impacted by how many others they are being bullied by. Calculate the correlation between the indegree and the grade of the kid.*

-   What is the correlation value?
-   What does it mean substantively?

```{r}
grade = attr$Grade
cor_value = cor(grade, indegree, method = c("pearson"))
summary(cor_value)

# Creating the plot
plot(grade, indegree, pch = 19, col = "#001219")
abline(lm(indegree ~ grade), col = "#ae2012", lwd = 3)
text(1,4, paste("Cor:", round(cor_value, 2)), col = 2, adj = c(0, -.1)) 

```

------------------------------------------------------------------------

*Perform a significance test using a permutation-based approach for the correlation as discussed in class. What does the significance test do and what do you conclude?*

```{r}
```


# Centralization and reciprocity

## Centralization

<aside>
ðŸ’¡ *Calculate the in-degree and out-degree centralization for this network using the approach discussed in class and interpret. Make sure to show how you came to these answers.*

    
ðŸ’¡ *What do you conclude substantively (taking into account that the network is "who do you bully?")?*

ðŸ’¡ *Make sure to discuss the reference points for the measure. What is the minimum and maximum value?*

</aside>

Centralization is a question about how central some nodes are compared to other nodes, it is a characteristic of the network itself. It's related to the distribution of the centrality inside the network, while centrality is more related to the individual sphere of the nodes. 

In an undirected network, centralization is computed as follows:

$$
Centralisation = \frac{\sum (\max-degree_i)}{(n-1)(n-2)}
$$
The most centralized network is the one that has a single node in the center, which that links every other node in the network. In this case the maximum degree is $(n-1)$, therefore the centralization index is:

$$
C = \frac{(24-1)*24+(24-24)*1}{24*23} = \frac{23*24}{23*24} = 1
$$
while in the opposite case, in a decentralized network where every node is linked to everybody else, the centralization index is:

$$
C = \frac{(24-24)*25}{24*23} = \frac{0}{23*24} = 0
$$

```{r}
# Total degree centralisation
sna::centralization(net,sna::degree)
```
In the studied network, the centralization index is $0.111413$, which indicates a fairly decentralized network. 

Since the bullying network is directed, it is possible to distinguish the centralization index into in degree and out degree. As the table shows, the in degree is higher than the out degree centralization index, indicating a more centralized bullied network (i.e. a few of them are bullied from many) and a less centralized bullying network (i.e. nearly everybody bullies others). Notice that both these indexes are higher than the previous centralization index, indicating two more centralized networks if separated than if joined in an undirected one. 

```{r}
      # In degree centralisation
formattable(data.frame(cbind("In degree Centralisation Index" = sna::centralization(net,sna::degree, cmode="indegree"),
      # Out degree centralisation
      "Out degree Centralisation Index" = sna::centralization(net,sna::degree, cmode="outdegree"))))
```

Considering the maximal (i.e. $1$) and minimal (i.e. $0$) values reachable in terms of centralization index, the computed ones are closer to the minimal reference point than the maximal, leading to the conclusion of a decentralized network. 

The following table resumes closeness, betweenness and Bonacich Power centrality per each student:

```{r}
## Betweenness centrality
betweenness = sna::betweenness(net, gmode="digraph")/(25*24/2)
## Bonacich Power Centrality
bonpow = sna::bonpow(net, gmode="digraph", exponent=0)

## Constraint index
library(igraph)
i_net<-graph_from_adjacency_matrix(as.matrix(read.csv("bullying_network.csv",
                                                      row.names = 1, 
                                                      stringsAsFactors = F)),
                                   mode="directed", diag=F)

con_ind = constraint(i_net)
```

```{r echo=FALSE}
as.datatable(formattable(data.frame(cbind(betweenness,
                             bonpow,
                             con_ind)),
            'betweenness' = color_bar("lightpink"),
            align = c("l",rep("c",3))))
```

## Reciprocity

<aside>
ðŸ’¡ *Calculate the arc-based reciprocity index for this network and interpret. Make sure to show how you came to this answer.*

</aside>

<aside>
ðŸ’¡ *What do you conclude substantively (taking into account that the network is "who do you bully?")?*

</aside>

<aside>
ðŸ’¡ *Make sure to discuss the reference points for the measure. What is the minimum, expected and maximum value?*

</aside>

```{r}
sna::dyad.census(net)
```

Letâ€™s start with a census about dyads, which will return how many mutual, asymmetric and null dyads there are in the network. Given $25$ nodes, the maximal number of edges is $(25*24)/2 = 300$, while the minimal is $0$. According to the census, there are:

* 4 mutual edges: Francesco - Andrea, Flavio - Giulia, Angelo - Giulia and Marco - Sara. By looking at their degree centrality, we can notice that:
    - Flavio and Marco bully just one person per each (i.e. Giulia and Sara) respectively, but their victim, in turn, bully them, creating a cycle of attack and defence;
    - Giulia appears twice in these mutual edges, which are half her in and out-edges. This could imply her capacity to respond to her bullies by bullying in return.
    
```{r}
# Mutual edges
E(i_net)[which_mutual(i_net)]

# Degree Centrality of nodes with mutual links
people %>%
  filter(Name %in% c("Francesco", "Andrea", 
                     "Flavio", "Marco", 
                     "Giulia", "Sara", "Angelo"))
```
    
* 68 asymmetrical edges;
* 228 null or missing edges.

Next, the reciprocity index is computed as the number of mutual dyads in the network over the total amount of possible mutual dyads:

$$
Reciprocity = \frac{2*M}{2*M+A}
$$

```{r}
sna::grecip(net, measure="edgewise"s)
```

If there wasnâ€™t any mutual edge, reciprocity would have been 0:

$$
Reciprocity_{min} = \frac{2*M}{2*M+A} = \frac{2*0}{2*0+A}=0
$$

If instead all edges were mutual, the highest reachable value would have been 1:

$$
Reciprocity_{max} = \frac{2*M}{2*M+A} = \frac{2*M}{2*M}=1
$$

With respect to the edgewise or tie or arc-based reciprocity, i.e. the proportion of edges that are reciprocated, we get a reciprocity index of $0.1052632$ and thus indicating the lack of mutual edges, albeit not their absence.

Considering instead the dyadic measure for reciprocity, we obtain the proportion of mutual and null edges over the total (i.e. mutual, asymmetrical and null), getting a $0.733$ reciprocity score. 
```{r}
sna::grecip(net, measure="dyadic")
```

By removing null edges, the index falls to $0.05555556$, indicating that over the 5% of edges is mutual and therefore that over 5% of students bully each other mutually. 
```{r}
sna::grecip(net, measure="dyadic.nonnull")
```